(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function s(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=s(n);fetch(n.href,l)}})();const o=e=>document.getElementById(e),U=e=>document.getElementsByClassName(e)[0],g=e=>{e.classList.add("forceHoverEffect")},m=e=>{e.classList.remove("forceHoverEffect")},c=(e,t)=>{chrome.storage.local.set({[e]:t})},z=e=>new Promise(t=>{chrome.storage.local.get(e,s=>{t(s)})}),X=()=>{chrome.action.setIcon({path:"/images/browser/icon128_disabled.png"})},_=()=>{chrome.action.setIcon({path:"/images/browser/icon128.png"})},q=()=>{document.body.classList.add("enabled")},K=()=>{document.body.classList.remove("enabled")},j=()=>{popupEnableChangeBgEffect.classList.add("grow")},J=()=>{popupEnableChangeBgEffect.classList.remove("grow")},Q=()=>{j(),q()},ee=()=>{J(),K()},B=e=>{e?(Q(),_()):(ee(),X())},te=()=>{appEnableCheckboxBtn.classList.add("switcher-enable")},oe=()=>{appEnableCheckboxBtn.classList.remove("switcher-enable")},ne=()=>{te(),c("snowfallEnable",!0)},se=()=>{oe(),c("snowfallEnable",!1)},M=e=>{if(typeof e!="boolean")throw`incorrect new app state - ${e}`;e?ne():se()},le=()=>{donateBtn.classList.add("show")},ce=()=>{donateBtn.classList.remove("show")},I=e=>{e?le():ce()},ae=({target:e})=>{B(e.checked),M(e.checked),I(e.checked)};appEnableCheckbox.addEventListener("change",ae);document.addEventListener("contextmenu",e=>{e.preventDefault()});const ie=e=>{c("snowfallColor",e),A(e)};let P=null;const re=()=>P,V=e=>{if(e!=="static"&&e!=="dynamic")throw`incorrect mode type - ${e}`;P=e,c("snowfallColorMode",e)},k=()=>{V("static"),de(),we(),pe(),m(dynamicColorPlate),g(staticColorPlate)},x=()=>{V("dynamic"),ue(),fe(),Ce(),m(staticColorPlate),g(dynamicColorPlate)},de=()=>{snowColorStaticBtn.classList.add("colorize")},ue=()=>{snowColorStaticBtn.classList.remove("colorize")},A=e=>{document.body.style.setProperty("--userChosenColor",e)},fe=()=>{snowColorDynamicBtn.classList.add("colorize")},we=()=>{snowColorDynamicBtn.classList.remove("colorize")},Ce=()=>{snowColorDynamicInput.checked=!0},pe=()=>{snowColorDynamicInput.checked=!1},he=({target:e})=>{e.checked?x():k()};snowColorDynamicInput.addEventListener("change",he);const be=o("appEnableCheckbox");o("appEnableCheckboxBtn");U("appEnableCheckboxBtn_inner");o("snowflakesCountPlate");const ge=o("snowflakesCountInput");o("incSnowflakesCountBtn");o("decSnowflakesCountBtn");const me=o("ztopCheckbox");o("ztopCheckboxBtn");o("staticColorPlate");const S=o("snowColorStaticInput");o("snowColorStaticBtn");o("dynamicColorPlate");o("snowColorDynamicInput");o("snowColorDynamicBtn");const O=o("meltingSnowCheckbox"),Z=o("meltingSnowCheckboxBtn");o("advancedSettings");o("popupEnableChangeBgEffect");o("donateBtn");const $=o("modalLayer"),H=o("mouseMoveIcon"),T=o("blizzardDirectionModal"),ke=o("blizzardDirectionModalIcon"),v=o("blizzardDirectionIcon"),Se=o("blizzardStaticDirectionPlate"),ve=o("blizzardDynamicDirectionPlate"),Ee=()=>{re()==="dynamic"&&k()},De=({target:e})=>{ie(e.value)};S.addEventListener("input",De);S.addEventListener("click",Ee);const ye=()=>{g(snowflakesCountPlate)},Le=()=>{m(snowflakesCountPlate)};snowflakesCountInput.addEventListener("focus",ye);snowflakesCountInput.addEventListener("blur",Le);const ze=()=>{ztopCheckboxBtn.classList.add("enable")},Be=()=>{ztopCheckboxBtn.classList.remove("enable")},N=e=>{e?ze():Be()},Me=({target:e})=>{c("snowfallZtop",e.checked),N(e.checked)};ztopCheckbox.addEventListener("change",Me);const F=()=>{Z.classList.add("enable")},R=()=>{Z.classList.remove("enable")},Ie=()=>{c("snowfallMelting",!0),F()},Pe=()=>{c("snowfallMelting",!1),R()},Ve=e=>{e?Ie():Pe()},xe=({target:e})=>{Ve(e.checked)};O.addEventListener("change",xe);const i={snowfallEnable:!0,snowfallCount:100,snowfallColor:"#cd4c4c",snowfallZtop:!0,snowfallColorMode:"static",snowfallMelting:!0,snowfallDirectionMode:"dynamic",snowfallDirectionStaticAngle:0},C={blizzardDirection:T};let W;const Ae=e=>{if(!(e in C))throw`unknown modal name - ${e}`;W=e,C[e].classList.add("show"),$.classList.add("show")},Oe=()=>{$.classList.remove("show"),C[W].classList.remove("show")},Ze=170/2,f=340/2,$e=-180/Math.PI;let y,w;const Y=e=>{y=e.pageY<=f?f:e.pageY,w=Math.atan2(e.pageX-Ze,y-f)*$e+90,G(w),c("snowfallDirectionStaticAngle",w)},He=()=>{document.addEventListener("mousemove",Y)},Te=()=>{document.removeEventListener("mousemove",Y)},G=e=>{ke.style.transform=`rotate(${e}deg)`,v.style.transform=`rotate(${e}deg)`},Ne=()=>{Te(),Oe()},Fe=()=>{E("static"),T.addEventListener("click",Ne,{once:!0}),He(),Ae("blizzardDirection")},Re=()=>{H.classList.add("gray"),v.classList.remove("gray")},We=()=>{H.classList.remove("gray"),v.classList.add("gray")};let L;const E=e=>{L!==e&&(L=e,c("snowfallDirectionMode",e),e==="static"?Re():We())},Ye=async()=>{let e;e=await z({snowfallEnable:i.snowfallEnable,snowfallCount:i.snowfallCount,snowfallColor:i.snowfallColor,snowfallZtop:i.snowfallZtop,snowfallColorMode:i.snowfallColorMode,snowfallMelting:i.snowfallMelting,snowfallDirectionMode:i.snowfallDirectionMode,snowfallDirectionStaticAngle:i.snowfallDirectionStaticAngle}),be.checked=e.snowfallEnable,ge.value=e.snowfallCount,S.value=e.snowfallColor,me.checked=e.snowfallZtop,B(e.snowfallEnable),M(e.snowfallEnable),I(e.snowfallEnable),e.snowfallColorMode==="static"?k():x(),A(e.snowfallColor),N(e.snowfallZtop),O.checked=e.snowfallMelting,e.snowfallMelting?F():R(),E(e.snowfallDirectionMode),G(e.snowfallDirectionStaticAngle)};class Ge{constructor(t,s=0,a=()=>{},n=()=>{}){this.prevValue=String(s),this.checker=t,this.successCallback=a,this.unsuccessCallback=n}handleEvent(t){const s=t.target.value;if(this.checker(s))this.updatePrevValue(s),this.successCallback(s);else{const n=t.target.selectionStart;this.restore(t.target,s,n),this.unsuccessCallback()}}restore(t,s,a){this.restorePrevValue(t),this.restorePrevCaretPos(t,s,a)}restorePrevValue(t){t.value=this.prevValue}restorePrevCaretPos(t,s,a){const n=s.length,l=a-(n-this.prevValue.length);t.setSelectionRange(l,l)}updatePrevValue(t){this.prevValue=t}getPrevValue(){return this.prevValue}dispatchInput(t){t.target.value=t.newValue,this.handleEvent(t)}}const p=1,h=1e3,Ue=e=>e!=="",Xe=e=>e>=p,_e=e=>e<h,qe=/^\d+$/,Ke=e=>qe.test(e),je=e=>Ue(e)&&Ke(e)&&Xe(e)&&_e(e);let b=null;const d=e=>{const s=D()+e;b.dispatchInput({target:snowflakesCountInput,newValue:s})},D=()=>Number(snowflakesCountInput.value),Je=e=>{c("snowfallCount",e)},Qe=async()=>{{const{snowfallCount:e}=await z({snowfallCount:i.snowfallCount});b=new Ge(je,e,Je),snowflakesCountInput.addEventListener("input",b)}};Qe();const r=10,et=()=>{const e=D(),t=-(e-r<=p?e-p:r);d(t)},tt=()=>{const e=D(),t=e+r>h?h-(e+1):r;d(t)},ot=({deltaY:e})=>{e<0?tt():e>0&&et()};snowflakesCountInput.addEventListener("wheel",ot);const nt=()=>{d(1)},st=()=>{d(-1)};incSnowflakesCountBtn.addEventListener("click",nt);decSnowflakesCountBtn.addEventListener("click",st);const lt=()=>{Fe()};Se.addEventListener("click",lt);const ct=()=>{E("dynamic")};ve.addEventListener("click",ct);Ye();
